<html>
<body>
<div id="text"></div>
<div id="recognizedText"></div>
<input type="button" onClick="recognitionStart();" value='開始'>
<input type="button" onClick="recognitionStop();" value='停止'>
<script type="text/javascript">
//各ブラウザで異なる部分を統一
navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL;
window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext || window.msAudioContext;

var recognition = new webkitSpeechRecognition();

function initialize() {
if (!('webkitSpeechRecognition' in window)) {
  window.alert("お使いのブラウザは音声チャットに対応していません．GoogleChromeをご利用ください．");
} else {
  var text = document.getElementById("text");
  var recognizedText = document.getElementById("recognizedText");

recognition.lang = 'ja-JP';
recognition.continuous = true;
recognition.interimResults = true;
//話し声の認識中
recognition.onsoundstart = function(){
console.log('start');
text.innerHTML='start';
};
//話し声の認識終了
recognition.onsoundend = function(){
console.log('stop');
text.innerHTML='stop';
};
  //認識結果
  recognition.onresult = function(event) { 
      var results = event.results;
    for (var i = event.resultIndex; i<results.length; i++){
        recognizedText.innerHTML=results[i][0].transcript+'\n';
    }
  };
}
}
window.addEventListener("load", initialize, false);

function recognitionStart(){
console.log(recognition);
  recognition.start();
}

function recognitionStop(){
  recognition.stop();
}
</script>
</body>
</html>